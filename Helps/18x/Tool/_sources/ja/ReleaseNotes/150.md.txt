# 1.50 新機能

## マテリアル

マテリアルの機能が追加されました。

ノードで独自のマテリアルを作成、使用できるようになりました。

モデルからライティングが削除されました。描画共通から歪みが削除されました。それらの代わりにパラメーターを整理しました。

描画共通に、標準、歪み、ライティングのマテリアルを加えました。

サンプラーをカラーとは別に設定できるようになりました。

モデル以外もライティングに対応しました。

UVの計算に使用する画像を選択できるようになりました。また、画像がなくともUVを指定できるようになりました。

(破壊的変更) 不具合により、歪みがリファレンス通りの挙動をしていなかったため修正しました。
スプライト以外は頂点の色を赤色と緑色を入れ替えると前のバージョンと同じ仕様になります。
スプライトは赤色かつ強度を2倍にすると前バージョンと同じ仕様になります。

(破壊的変更) 読み込み時の拡大率を歪みに適用するようにしました。
拡大率をと歪みも強くなります。
そのため、エフェクトが画面内で同じ面積を占める時の歪み方が変わらなくなります。

(破壊的変更) モデル以外のライティングにともない、ビルボードの挙動が一部変更されました。配置方法が固定以外のモデル、及び、奥行き方向に伸ばしたリングが特に影響を受けます。
1.4の挙動を再現するには前後を逆にする必要があります。

(破壊的変更) DirectX11で位置が同じだとしても描画されるように仕様変更しました。基本的に影響はないですが、同じ位置に描画したときに変化がある可能性があります。

(破壊的変更) スプライトの描画順を逆にしたときに正しく実行されない不具合を修正しました。

## 動的パラメーター

エフェクトのパラメーターをアプリケーション内で再生中に書き換える機能が追加されました。

## 新フォーマット

efkprojとefkが結合し、efkefcになりました。今までのように別ファイルを出力する必要がなくなりました。かわりに読み込み時拡大率をランタイムで指定する必要があります。

## 録画

録画した結果を通常と加算に分離して出力することで、背景を変えた場合の色を可能な範囲で再現するようになりました。通常と加算が混ざったエフェクトも録画できます。

本体かプロジェクトかどちらに録画設定を保存するか指定できるようになりました。録画が必要なエフェクトの設定をエフェクトが持てるようになりました。

録画に振る舞いが反映されるようになりました。ループエフェクトの録画が容易になりました。

スプレッドシートとして録画すると余計なフレームが録画される不具合を修正しました。

## UI

様々な点でノードツリーの挙動が改善されました。

様々な点でFカーブの挙動が改善されました。

パネルごとにコピー＆ペーストができるようになりました。

デフォルトから値が変更された部分が強調されるようになりました。

DPIスケールの変更に対応しました。

文字列入力中にスペースの入力で再生が始まる不具合を修正しました。

フォントとフォントサイズを変更するオプションを追加しました。

## 環境

ブルームやトーンマッピングをエディタ上で設定できるようになりました。
エディタの見た目にのみ適用なのでエフェクトの挙動の確認用です。
変更する回数が多いため、背景とライティングを環境に移動しました。

## スプライト、リング、モデル

(破壊的変更) ```Z軸回転ビルボード```の回転方向が逆になりました。

## 軌跡

(破壊的変更) 軌跡の左右が反転しました。

## リング

現在の描画角度の設定から円の形状の設定に変更しました。
三日月型を設定すると一部が切れた円を設定できます。
円の開始終了角度およびフェード角度を設定できます。

(破壊的変更) 描画角度の設定によっては見た目が変化することがあります。

## リボン、軌跡

UVの繰り返しパターンの設定をできるようになりました。
今までは、指定したUV全体をリボン、軌跡全体に設定していましたが、
長さに応じてUVを繰り返せるようになりました。端のみ繰り返さない設定もできます。
鎖等の繰り返しパターンがある表現に適しています。

## Fカーブ

パーティクルが消滅する時間を100として、値の変化を設定できるようにしました。加えて、デフォルトを100%の設定に変更しました。

## 深度

距離が変化しても大きさが変化しないように設定するパラメーターを追加しました。変化を抑制のみもできます。

深度オフセットをリボンと軌跡にも適用するようにしました。

Zソートをリングとモデルにも適用するようにしました。

(破壊的変更) オフセットによる拡大の無効化の計算が間違っていた部分を修正しました。

## 引力

力場に名前が変更されました。
乱流が実装されました。

## 最適化

更新処理が30から50%の高速化されます。

## 視点

現在の視点を保存、読み込みできるようになりました。

視点でニア―ファークリップを設定できるようになりました。

## 他

ボーンなしFBXやアニメーションなし、かつボーンありFBXの読込に対応に対応しました。

振る舞いに再生速度が追加されました。

(破壊的変更) 乱数がオーバーフローしていた不具合を修正しました。ランダムの振る舞いが変わる可能性があります。
